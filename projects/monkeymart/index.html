<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, minimal-ui, shrink-to-fit=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>MonkeyMart</title>
    <style type="text/css">
      body { position: fixed; margin:0; padding:0; }
      .canvas-app-container { width:100%; height:100%; position:absolute; align-items:center; justify-content:center; overflow:hidden; }
      .canvas-app-container:-webkit-full-screen { width:auto; height:auto; }
      #canvas { outline:none; border:0; width:100%; vertical-align:bottom; }
      #canvas-container { position:relative; }
      canvas:focus, canvas:active { outline:none; border:0; -moz-outline-style:none; }
      div { -webkit-tap-highlight-color: rgba(0,0,0,0); -webkit-touch-callout:none; -webkit-user-select:none; -khtml-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; }
      .banner-styleBottom { margin:0 auto; position:fixed; bottom:0; display:block; left:50%; transform:translateX(-50%); }
      .banner-styleTop { margin:0 auto; position:fixed; top:0; display:block; left:50%; transform:translateX(-50%); }
      .canvas-app-progress { position:absolute; background-color:#0A8A40; height:30px; margin-top:-30px; width:100%; }
      .canvas-app-progress-bar { font-size:12px; height:30px; color:#fff; background-color:#FFE333; text-align:center; line-height:20px; }
      .buttons-background { background-color:#ffffff; width:100%; height:42px; }
      body { background-color:#ffffff; }
      .canvas-app-container { background:#00BB61; }
      .canvas-app-canvas { background-repeat:no-repeat; background-position:top; background-size:cover; background-image:url("../3kh0-assets-main-MonkeyMart/MonkeyMart/bg_loading.png"); }
    </style>
    <script src="../3kh0-assets-main-MonkeyMart/MonkeyMart/poki-sdk.js"></script>
  </head>
  <body>
    <div id="app-container" class="canvas-app-container" style="width: 640px; height: 360px;">
      <div id="canvas-container" class="canvas-app-canvas-container">
        <canvas id="canvas" class="canvas-app-canvas" tabindex="1" width="640" height="360"></canvas>
      </div>
      <div class="buttons-background"></div>
      <div id="progress-bar-root" style="position: absolute; bottom: 29px; left: 50%; visibility: visible; z-index: 4;">
        <img id="progress-bar-bg" src="../3kh0-assets-main-MonkeyMart/MonkeyMart/load_bar_bg.png" width="270" style="margin-left: -135px;">
        <img id="progress-bar-fg" src="../3kh0-assets-main-MonkeyMart/MonkeyMart/load_bar_fg.png" style="position: absolute; clip: rect(0px, 137.942px, 22px, 0px); margin-top: 0px; margin-left: -270px;" width="270">
      </div>
    </div>
    <script id="engine-loader" type="text/javascript" src="../3kh0-assets-main-MonkeyMart/MonkeyMart/dmloader.js"></script>
    <script id="engine-setup" type="text/javascript">
      var extra_params = {
        archive_location_filter: function(path){ return ("../3kh0-assets-main-MonkeyMart/MonkeyMart/archive" + path + ""); },
        engine_arguments: ["--verify-graphics-calls=false"],
        custom_heap_size: 67108864,
        full_screen_container: "#canvas-container",
        disable_context_menu: true
      };
      Module['INITIAL_MEMORY'] = extra_params.custom_heap_size;
      Module['onRuntimeInitialized'] = function(){ Module.runApp("canvas", extra_params); };
      Module["locateFile"] = function(path, scriptDirectory){
        if (path == "dmengine.wasm" || path == "dmengine_release.wasm" || path == "dmengine_headless.wasm") { path = "MonkeyMart.wasm"; }
        return "../3kh0-assets-main-MonkeyMart/MonkeyMart/" + path;
      };
      var is_iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
      var buttonHeight = 0;
      var prevInnerWidth = -1;
      var prevInnerHeight = -1;
      function resize_game_canvas(){
        if (is_iOS) { window.scrollTo(0,0); }
        var app_container = document.getElementById('app-container');
        var game_canvas = document.getElementById('canvas');
        var progress_bar_root = document.getElementById('progress-bar-root');
        var progress_bar_fg = document.getElementById('progress-bar-fg');
        var progress_bar_bg = document.getElementById('progress-bar-bg');
        var innerWidth = window.innerWidth;
        var innerHeight = window.innerHeight - buttonHeight;
        if (prevInnerWidth == innerWidth && prevInnerHeight == innerHeight) { return; }
        prevInnerWidth = innerWidth;
        prevInnerHeight = innerHeight;
        var width = innerWidth;
        var height = innerHeight;
        app_container.style.width = width + "px";
        app_container.style.height = height + buttonHeight + "px";
        game_canvas.width = width;
        game_canvas.height = height;
        var bar_h = width < height ? width : height;
        progress_bar_bg.width = Math.min(Math.ceil(bar_h * 0.06 * 300/24), width * 0.8);
        progress_bar_bg.style.marginLeft = - progress_bar_bg.width/2 + "px";
        progress_bar_fg.width = Math.ceil(progress_bar_bg.width * 1);
        progress_bar_fg.style.marginTop = (progress_bar_bg.width * 0) * (0)/2 + "px";
        progress_bar_fg.style.marginLeft = -progress_bar_bg.width/2 - progress_bar_fg.width/2 + "px";
        progress_bar_root.style.bottom = Math.ceil(height*0.08 + buttonHeight) + "px";
      }
      resize_game_canvas();
      window.addEventListener('resize', resize_game_canvas, false);
      window.addEventListener('orientationchange', resize_game_canvas, false);
      window.addEventListener('focus', resize_game_canvas, false);
    </script>
    <script id="engine-start" type="text/javascript">
      var currentPercentage = 0;
      Progress.updateProgress = function(percentage){
        Progress.notifyListeners(percentage);
        if(currentPercentage>percentage){ percentage = currentPercentage; }
        currentPercentage = percentage;
        var fg = document.getElementById('progress-bar-fg');
        if (fg) { fg.style.clip = "rect(0px," + (fg.width * percentage/100) + "px," + fg.height + "px,0px)"; }
        if(isNaN(percentage)){
          var root = document.getElementById('progress-bar-root');
          if (root) root.style.visibility = "hidden";
        }
      };
      Progress.addProgress = function(){ var root = document.getElementById('progress-bar-root'); if (root) root.style.visibility = "visible"; };
      Progress.removeProgress = function(){ var root = document.getElementById('progress-bar-root'); if (root) root.style.visibility = "hidden"; Module.canvas.style.background = ""; };
      EngineLoader.stream_wasm = false;
      EngineLoader.load("canvas", "MonkeyMart");
    </script>
    
  </body>
</html>
